# SCMU自动选课助手 V1.1.0 发布说明

---

## 🎉 版本概述

**发布日期**: 2025年12月9日
**版本类型**: 重大功能更新
**主题**: 多课程类型支持版本

V1.1.0 是一个重要的里程碑版本，引入了 7 种课程类型的完整支持，大幅提升了选课成功率。同时实现了三个版本间的完全功能对等，提供了更完善的用户体验和数据持久化功能。

---

## ✨ 主要新功能

### 🎓 7种课程类型支持

这是 V1.1.0 最重要的功能更新，支持中南民族大学选课系统的所有课程类型：

| 课程类型 | 代码 | 适用场景 | 特点 | 推荐指数 |
|---------|------|----------|------|----------|
| 推荐选课 | TJXK | 系统推荐的专业课程 | 优先级高，成功率高 | ⭐⭐⭐⭐⭐ |
| 方案内选课 | BFAK | 培养方案内的必修课程 | 专业必修课 | ⭐⭐⭐⭐ |
| 方案外选课 | KZYXK | 培养方案外的选修课程 | **最常用** | ⭐⭐⭐⭐⭐ |
| 重修选课 | CXXK | 重修之前未通过的课程 | 挂科重修专用 | ⭐⭐⭐⭐ |
| 体育选择课 | TYKXK | 体育类选修课程 | 体育选修 | ⭐⭐⭐ |
| 通识课程选修 | QXGXK | 通识教育选修课程 | 需要志愿等级 | ⭐⭐⭐⭐ |
| 创新创业类选修课 | CXCY | 创新创业教育类选修 | 创新课程 | ⭐⭐⭐ |

#### 课程类型技术特性

- **智能API适配**: 每种课程类型使用对应的API端点
- **参数化配置**: 支持志愿等级、实验班等差异化参数
- **类型验证**: 自动验证课程ID与类型的匹配性
- **错误恢复**: 类型错误时的智能降级处理

### 👨‍💻 作者信息和版权声明

完整的开源项目合规化：

- **控制台版权信息**: 启动时显示完整的版权声明
- **界面作者展示**: 底部显示作者信息和GitHub链接
- **Apache 2.0合规**: 完整的许可证声明和使用条款
- **学习用途声明**: 明确禁止商业使用，仅限学习目的

```javascript
// 控制台输出示例
console.log(`
🎓 中南民族大学自动选课助手 V1.1.0
👨‍💻 作者: SuShuHeng (https://github.com/SuShuHeng)
🔗 项目地址: https://github.com/SuShuHeng/SCMU_CC_Helper
📜 许可证: Apache 2.0
⚠️ 本项目仅用于学习目的，禁止用于商业用途！
`);
```

### 📝 增强的课程名称管理

- **自定义名称**: 支持为每门课程添加易识别的名称
- **持久化存储**: 名称信息与课程数据一起保存
- **智能默认**: 提供友好的默认名称提示
- **实时更新**: 名称修改立即生效并保存

---

## 🔧 技术架构升级

### 🔄 版本功能完全对等

解决了长期存在的版本差异问题：

- **单文件版本** (`dist/course-helper.js`) - 功能完整
- **油猴版本** (`dist/tampermonkey-course-helper.js`) - 功能完整
- **模块化版本** (`src/` 目录) - 功能完整

三个版本现在拥有：
- ✅ 完全相同的课程类型支持
- ✅ 一致的用户界面和交互
- ✅ 统一的数据持久化机制
- ✅ 相同的错误处理和恢复逻辑

### 💾 数据持久化优化

- **课程类型存储**: 新增课程类型的本地存储支持
- **数据版本升级**: V1.0.0 → V2.0.0 数据格式升级
- **向后兼容**: 保持对旧版本数据的兼容性
- **迁移机制**: 自动检测和迁移历史数据

### 🎨 用户界面改进

#### 课程类型选择界面
- **直观下拉选择**: 清晰的类型选择下拉框
- **场景提示**: 每种类型都有使用场景说明
- **智能默认**: 自动选择最常用的"方案外选课"
- **实时预览**: 选择时立即显示类型特性

#### 增强的状态显示
- **类型信息**: 状态面板显示每门课程的类型
- **成功统计**: 按类型统计选课成功率
- **运行监控**: 实时显示运行时间和性能指标

---

## 🐛 重要问题修复

### 🏁 竞态条件彻底修复

解决了 V1.0.4 中的数据加载时序问题：

- **事件监听优化**: 确保UI组件在数据加载前初始化
- **加载状态管理**: 完善的加载状态跟踪机制
- **重试机制**: 数据加载失败时的自动重试
- **错误恢复**: 加载异常时的优雅降级

### 🔧 内存管理优化

- **定时器清理**: 确保所有定时器在适当时机清理
- **事件监听移除**: 避免内存泄漏的事件监听管理
- **DOM引用清理**: 及时清理无效的DOM引用
- **循环引用避免**: 优化对象间的引用关系

---

## 📊 API变更

### 新增课程类型配置

```javascript
// 新的课程类型配置
export const COURSE_TYPES = {
    TJXK: {
        method: 'handleTjxk',
        name: '推荐选课',
        needsGlJxbid: true,
        needsXkzy: false
    },
    // ... 其他6种类型
};
```

### LocalDataManager 数据版本升级

```javascript
// V2.0.0 数据格式
{
    courses: [
        {
            id: "courseId",
            name: "自定义名称",
            courseType: "KZYXK",  // 新增：课程类型
            addedTime: timestamp,
            status: { success: boolean }
        }
    ],
    experimentalClasses: { "courseId": ["expClassIds"] },
    metadata: {
        version: "2.0.0",         // 升级：数据版本
        sessionCount: number,
        lastSaved: timestamp
    }
}
```

---

## 📁 文件变更

### 新增文件

```
docs/
├── v1.1.0-release-notes.md   # 本发布说明
├── course-types-guide.md     # 课程类型使用指南
└── migration-guide.md        # 版本迁移指南
```

### 修改文件

**源代码文件** (全部更新至 V1.1.0)
- `src/config.js` - 新增课程类型配置
- `src/course-registration.js` - 支持课程类型选课
- `src/local-data-manager.js` - 数据版本升级
- `src/ui-controller.js` - 课程类型选择界面

**发布文件** (全部更新至 V1.1.0)
- `dist/course-helper.js` - 功能对等的单文件版本
- `dist/tampermonkey-course-helper.js` - 功能对等的油猴版本
- `README.md` - 文档更新，包含新功能说明

---

## 🔄 升级指南

### 对于新用户

1. 下载最新版本的 `dist/course-helper.js` 或 `dist/tampermonkey-course-helper.js`
2. 按照安装说明进行设置
3. 在添加课程时选择合适的课程类型

### 对于 V1.0.4 用户

**自动升级**:
- 油猴版本：替换脚本内容即可，数据会自动迁移
- 单文件版本：替换代码内容，刷新页面即可

**手动升级**:
1. 备份现有课程数据（可选）
2. 下载新版本代码
3. 替换旧版本代码
4. 刷新选课系统页面
5. 验证课程数据是否正确恢复

**迁移说明**:
- ✅ 所有课程ID和名称会自动保留
- ✅ 选课状态会正确恢复
- ✅ 课程类型默认设置为"方案外选课"
- ✅ 建议检查并调整课程类型设置

---

## ⚠️ 注意事项

### 重要提醒

- **课程类型选择**: 请务必选择正确的课程类型，否则可能导致选课失败
- **数据备份**: 升级前建议备份重要的课程信息
- **兼容性**: V1.1.0 与 V1.0.4 数据完全兼容
- **学习用途**: 本工具仅用于学习目的，请遵守学校规定

### 已知限制

- 部分课程类型可能需要特殊的权限或条件
- 通识课程选修需要设置志愿等级
- 实验班功能在部分课程类型中不可用

---

## 🤝 贡献

### 问题反馈

如果在使用过程中遇到问题，请：

1. 查看 [故障排除指南](troubleshooting.md)
2. 检查 [课程类型使用指南](course-types-guide.md)
3. 在 GitHub 上提交 Issue

### 功能建议

欢迎提出功能建议和改进意见：

- 课程类型使用反馈
- 界面体验改进
- 性能优化建议
- 新功能需求

---

## 🎯 后续计划

### V1.1.1 计划功能

- [ ] 课程冲突检测和智能提醒
- [ ] 批量课程类型设置
- [ ] 选课策略智能推荐
- [ ] 更丰富的统计和导出功能
- [ ] 多账户支持和快速切换

### 长期规划

- 移动端适配
- 云端数据同步
- 智能选课算法
- 社区功能集成

---

## 📥 下载地址

**官方下载**: [https://github.com/SuShuHeng/SCMU_CC_Helper/releases](https://github.com/SuShuHeng/SCMU_CC_Helper/releases)

**文件选择**:
- `dist/course-helper.js` - 单文件版本（推荐新手）
- `dist/tampermonkey-course-helper.js` - 油猴脚本版本（推荐日常使用）
- 源代码 - 适合开发者自定义

---

**感谢您使用 SCMU 自动选课助手！如果这个项目对您有帮助，请给个 ⭐ 支持一下！**

---

*发布时间: 2025年12月9日*
*文档版本: V1.1.0*